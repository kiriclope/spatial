(* ::Package:: *)

(*uE[xc,\[CapitalGamma]0,\[Sigma]0] = Simplify[ Ie0 
+ 2 Jee/\[Lambda]e Cosh[xc/\[Lambda]e] Integrate[Exp[-y/\[Lambda]e] Part[rPos[y,\[CapitalGamma]0,\[Sigma]0],1],{y,xc,Infinity}]
- 2 Jei/\[Lambda]i ( Cosh[xc/\[Lambda]i] Integrate[Exp[-y/\[Lambda]i] Part[rPos[y,\[CapitalGamma]0,\[Sigma]0],2],{y,xc,Infinity}] 
+ Exp[-xc/\[Lambda]i] Integrate[Cosh[y/\[Lambda]i] Part[rNeg[y,xc,\[CapitalGamma]0,\[Sigma]0],2],{y,0,xc}] ), \[Sigma]0>0 ] *)


uE[xc_,\[CapitalGamma]0_,\[Sigma]0_] := 1/2 (2 Ie0+(2 E^(-(xc/\[Lambda]e)) Ie0 Jee Jii Cosh[xc/\[Lambda]e])/(Jei Jie-Jee Jii)-(E^(-(xc/\[Lambda]e)-xc^2/(2 \[Sigma]0^2)) Jee Jei Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] (Sqrt[2] xc^3 \[CapitalGamma]0 \[Lambda]e^3+3 Sqrt[2] xc^2 \[CapitalGamma]0 \[Lambda]e^2 \[Sigma]0^2+3 Sqrt[2] xc \[CapitalGamma]0 \[Lambda]e \[Sigma]0^4+\[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (\[Sigma]0^4-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]))) Cosh[xc/\[Lambda]e])/((-Jei Jie+Jee Jii) Sqrt[\[Pi]] \[Lambda]e^3 \[Sigma]0^2 ((xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2)^(3/2))+(E^(\[Sigma]0^2/(2 \[Lambda]e^2)) Jee Jei \[CapitalGamma]0 (xc \[Lambda]e+\[Sigma]0^2) (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-\[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]) Cosh[xc/\[Lambda]e] Erf[Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]e \[Sigma]0)])/((-Jei Jie+Jee Jii) \[Sigma]0 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2])-(E^(-(xc/\[Lambda]i)-xc^2/(2 \[Sigma]0^2)) Jei Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Cosh[xc/\[Lambda]i] (2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jie Sqrt[\[Pi]] \[Lambda]i \[Sigma]0^2 Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]+Jee (Sqrt[2] xc^3 \[CapitalGamma]0 \[Lambda]i^3+3 Sqrt[2] xc^2 \[CapitalGamma]0 \[Lambda]i^2 \[Sigma]0^2+3 Sqrt[2] xc \[CapitalGamma]0 \[Lambda]i \[Sigma]0^4+\[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]+Sqrt[2] \[CapitalGamma]0 (\[Sigma]0^4-2 \[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2])))+E^((xc \[Lambda]i+\[Sigma]0^2)^2/(2 \[Lambda]i^2 \[Sigma]0^2)) Jee Sqrt[\[Pi]] \[CapitalGamma]0 \[Lambda]i \[Sigma]0 (xc \[Lambda]i+\[Sigma]0^2) (-Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2]+\[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]) Erf[Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]i \[Sigma]0)]))/((Jei Jie-Jee Jii) Sqrt[\[Pi]] \[Lambda]i^3 \[Sigma]0^2 ((xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2)^(3/2))+(E^(-xc (1/\[Lambda]e+1/\[Lambda]i)-xc^2/(2 \[Sigma]0^2)) Jei (E^((xc \[Lambda]e+\[Sigma]0^2)^2/(2 \[Lambda]e^2 \[Sigma]0^2)) Jei Jie Sqrt[\[Pi]] \[CapitalGamma]0 \[Lambda]e \[Sigma]0 (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-\[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]) Erf[Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]e \[Sigma]0)] (-\[Lambda]i Cosh[xc/\[Lambda]i] Sinh[xc/\[Lambda]e]+\[Lambda]e Cosh[xc/\[Lambda]e] Sinh[xc/\[Lambda]i])+1/(xc \[Lambda]e+\[Sigma]0^2) \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2] (\[Lambda]i Cosh[xc/\[Lambda]i] (Sqrt[2] E^(xc/\[Lambda]e) (Jei Jie-Jee Jii) xc \[CapitalGamma]0 \[Lambda]e^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]-Jie (Sqrt[2] Jei xc \[CapitalGamma]0 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jii Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jei \[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]))) Sinh[xc/\[Lambda]e])+\[Lambda]e (E^(xc/\[Lambda]e) (Jei Jie-Jee Jii) (2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]]+Sqrt[2] \[CapitalGamma]0) \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jie (Sqrt[2] Jei xc \[CapitalGamma]0 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jii Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jei \[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]))) Cosh[xc/\[Lambda]e]) Sinh[xc/\[Lambda]i])))/(Jii (-Jei Jie+Jee Jii) Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 (xc \[Lambda]e+\[Sigma]0^2)));


xcE[\[CapitalGamma]0_,\[Sigma]0_] := xc /. First[monitoredFindRoot[ uE[xc,\[CapitalGamma]0,\[Sigma]0], {xc, \[Sigma]0, 2 \[Sigma]0}, Method -> "Secant"]] ;


(*uI[xc_,\[CapitalGamma]0_,\[Sigma]0_] = Simplify[ Iext[xc,\[CapitalGamma]0,\[Sigma]0][[2]] 
+ 2 Jie/\[Lambda]e Cosh[xc/\[Lambda]e] Integrate[Exp[-y/\[Lambda]e] Part[rPos[y,\[CapitalGamma]0,\[Sigma]0],1],{y,xc,Infinity}] 
- 2 Jii/\[Lambda]i ( Cosh[xc/\[Lambda]i] Integrate[Exp[-y/\[Lambda]i] Part[rPos[y,\[CapitalGamma]0,\[Sigma]0],2],{y,xc,Infinity}] 
+ Exp[-xc/\[Lambda]i] Integrate[Cosh[y/\[Lambda]i] Part[rNeg[y,xc,\[CapitalGamma]0,\[Sigma]0],2],{y,0,xc}] ), \[Sigma]0>0 ]*)


uI[xc_,\[CapitalGamma]0_,\[Sigma]0_] := Ii0+(E^(-(xc^2/(2 \[Sigma]0^2))) \[CapitalGamma]0)/Sqrt[2 \[Pi]]+(E^(-(xc/\[Lambda]e)-xc^2/(2 \[Sigma]0^2)) Jie Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Cosh[xc/\[Lambda]e] (2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jii Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jei (Sqrt[2] xc^3 \[CapitalGamma]0 \[Lambda]e^3+3 Sqrt[2] xc^2 \[CapitalGamma]0 \[Lambda]e^2 \[Sigma]0^2+3 Sqrt[2] xc \[CapitalGamma]0 \[Lambda]e \[Sigma]0^4+\[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (\[Sigma]0^4-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2])))+E^((xc \[Lambda]e+\[Sigma]0^2)^2/(2 \[Lambda]e^2 \[Sigma]0^2)) Jei Sqrt[\[Pi]] \[CapitalGamma]0 \[Lambda]e \[Sigma]0 (xc \[Lambda]e+\[Sigma]0^2) (-Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+\[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]) Erf[Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]e \[Sigma]0)]))/(2 (Jei Jie-Jee Jii) Sqrt[\[Pi]] \[Lambda]e^3 \[Sigma]0^2 ((xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2)^(3/2))+1/(2 (Jei Jie-Jee Jii) Sqrt[\[Pi]] \[Lambda]i \[Sigma]0^2) E^(-(xc/\[Lambda]i)-xc^2/(2 \[Sigma]0^2)) (-(1/(Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]))Jii Cosh[xc/\[Lambda]i] (2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jie Sqrt[\[Pi]] \[Lambda]i \[Sigma]0^2 Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]+Jee (Sqrt[2] xc^3 \[CapitalGamma]0 \[Lambda]i^3+3 Sqrt[2] xc^2 \[CapitalGamma]0 \[Lambda]i^2 \[Sigma]0^2+3 Sqrt[2] xc \[CapitalGamma]0 \[Lambda]i \[Sigma]0^4+\[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]+Sqrt[2] \[CapitalGamma]0 (\[Sigma]0^4-2 \[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2] Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2])))+E^((xc \[Lambda]i+\[Sigma]0^2)^2/(2 \[Lambda]i^2 \[Sigma]0^2)) Jee Sqrt[\[Pi]] \[CapitalGamma]0 \[Lambda]i \[Sigma]0 (xc \[Lambda]i+\[Sigma]0^2) (-Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2]+\[Lambda]i Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2/\[Lambda]i^2]) Erf[Sqrt[(xc \[Lambda]i+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]i \[Sigma]0)])+1/(\[Lambda]e (xc \[Lambda]e+\[Sigma]0^2)) E^(-(xc/\[Lambda]e)) \[Lambda]i (E^((xc \[Lambda]e+\[Sigma]0^2)^2/(2 \[Lambda]e^2 \[Sigma]0^2)) Jei Jie Sqrt[\[Pi]] \[CapitalGamma]0 \[Lambda]e \[Sigma]0 (-Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+\[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]) Erf[Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]/(Sqrt[2] \[Lambda]e \[Sigma]0)] (-\[Lambda]i Cosh[xc/\[Lambda]i] Sinh[xc/\[Lambda]e]+\[Lambda]e Cosh[xc/\[Lambda]e] Sinh[xc/\[Lambda]i])-1/(xc \[Lambda]e+\[Sigma]0^2) \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2] (\[Lambda]i Cosh[xc/\[Lambda]i] (Sqrt[2] E^(xc/\[Lambda]e) (Jei Jie-Jee Jii) xc \[CapitalGamma]0 \[Lambda]e^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]-Jie (Sqrt[2] Jei xc \[CapitalGamma]0 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jii Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jei \[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]))) Sinh[xc/\[Lambda]e])+\[Lambda]e (E^(xc/\[Lambda]e) (Jei Jie-Jee Jii) (2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]]+Sqrt[2] \[CapitalGamma]0) \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jie (Sqrt[2] Jei xc \[CapitalGamma]0 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]+2 E^(xc^2/(2 \[Sigma]0^2)) Ie0 Jii Sqrt[\[Pi]] \[Lambda]e \[Sigma]0^2 Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Jei \[Sigma]0^2 (-2 E^(xc^2/(2 \[Sigma]0^2)) Ii0 Sqrt[\[Pi]] \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]+Sqrt[2] \[CapitalGamma]0 (Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2]-2 \[Lambda]e Sqrt[(xc \[Lambda]e+\[Sigma]0^2)^2/\[Lambda]e^2]))) Cosh[xc/\[Lambda]e]) Sinh[xc/\[Lambda]i])));


(* ::InheritFromParent:: *)
(**)


xcI[\[CapitalGamma]0_,\[Sigma]0_] := xc /. First[monitoredFindRoot[ uI[xc,\[CapitalGamma]0,\[Sigma]0], {xc, \[Sigma]0, 2 \[Sigma]0}, Method -> "Secant"]] ;
